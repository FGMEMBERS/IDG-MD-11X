<?xml version="1.0"?>

<!-- McDonnell Douglas MD-11 Electrical System -->
<!-- Copyright (c) 2019 Joshua Davidson (it0uchpods) -->

<system name="MD-11: Electrical">
	
	<property value="0">/systems/electrical/bus/ac-tie-feedback</property>
	<property value="0">/systems/electrical/bus/dc-tie-feedback</property>
	
	<channel name="Sources/Buses" execrate="8">
		
		<!-- Battery 1 -->
		<fcs_function name="/systems/electrical/sources/bat1/volts">
			<function>
				<table>
					<independentVar lookup="row">/systems/electrical/sources/bat1/percent</independentVar>
					<independentVar lookup="column">/systems/failures/elec-batt1</independentVar>
					<tableData>
						      0  1
						  0   0  0
						 10  25  4
						100  28  7
					</tableData>
				</table>
			</function>
		</fcs_function>
		
		<switch name="/systems/electrical/sources/bat1/amp">
			<default value="0"/>
			<test logic="AND" value="2">
				/controls/electrical/switches/battery eq 1
				/systems/electrical/sources/bat1/volts ge 10
			</test>
		</switch>
		
		<!-- Battery 2 -->
		<fcs_function name="/systems/electrical/sources/bat2/volts">
			<function>
				<table>
					<independentVar lookup="row">/systems/electrical/sources/bat2/percent</independentVar>
					<independentVar lookup="column">/systems/failures/elec-batt2</independentVar>
					<tableData>
						      0  1
						  0   0  0
						 10  25  4
						100  28  7
					</tableData>
				</table>
			</function>
		</fcs_function>
		
		<switch name="/systems/electrical/sources/bat2/amp">
			<default value="0"/>
			<test logic="AND" value="2">
				/controls/electrical/switches/battery eq 1
				/systems/electrical/sources/bat2/volts ge 10
			</test>
		</switch>
		
		<!-- IDG Engine 1 -->
		<fcs_function name="/systems/electrical/sources/idg1/csd-gearbox-ratio"> <!-- Goal is 75% RPM -->
			<function>
				<table>
					<independentVar lookup="row">/engines/engine[0]/n2-actual</independentVar>
					<tableData>
						 60  1.25000000000
						 70  1.07142857143
						 75  1.00000000000
						 80  0.93750000000
						 90  0.83333333333
						100  0.75000000000
						110  0.68181818182
						120  0.62500000000
					</tableData>
				</table>
			</function>
		</fcs_function>
		
		<pure_gain name="/systems/electrical/sources/idg1/csd-percent-rpm">
			<input>/engines/engine[0]/n2-actual</input>
			<gain>/systems/electrical/sources/idg1/csd-gearbox-ratio</gain>
		</pure_gain>
		
		<fcs_function name="/systems/electrical/sources/idg1/output-volt">
			<function>
				<product>
					<property>/controls/electrical/switches/gen-drive-1</property>
					<ifthen>
						<eq>
							<property>/systems/failures/elec-gen1</property>
							<value>1</value>
						</eq>
						<value>0</value>
						<table>
							<independentVar lookup="row">/systems/electrical/sources/idg1/csd-percent-rpm</independentVar>
							<tableData>
								74    0
								75  115
							</tableData>
						</table>
					</ifthen>
				</product>
			</function>
		</fcs_function>
		
		<fcs_function name="/systems/electrical/sources/idg1/output-hertz">
			<function>
				<ifthen>
					<ge>
						<property>/systems/electrical/sources/idg1/output-volt</property>
						<value>110</value>
					</ge>
					<value>400</value>
					<value>0</value>
				</ifthen>
			</function>
		</fcs_function>
		
		<!-- IDG Engine 2 -->
		<fcs_function name="/systems/electrical/sources/idg2/csd-gearbox-ratio"> <!-- Goal is 75% RPM -->
			<function>
				<table>
					<independentVar lookup="row">/engines/engine[1]/n2-actual</independentVar>
					<tableData>
						 60  1.25000000000
						 70  1.07142857143
						 75  1.00000000000
						 80  0.93750000000
						 90  0.83333333333
						100  0.75000000000
						110  0.68181818182
						120  0.62500000000
					</tableData>
				</table>
			</function>
		</fcs_function>
		
		<pure_gain name="/systems/electrical/sources/idg2/csd-percent-rpm">
			<input>/engines/engine[1]/n2-actual</input>
			<gain>/systems/electrical/sources/idg2/csd-gearbox-ratio</gain>
		</pure_gain>
		
		<fcs_function name="/systems/electrical/sources/idg2/output-volt">
			<function>
				<product>
					<property>/controls/electrical/switches/gen-drive-2</property>
					<ifthen>
						<eq>
							<property>/systems/failures/elec-gen2</property>
							<value>1</value>
						</eq>
						<value>0</value>
						<table>
							<independentVar lookup="row">/systems/electrical/sources/idg2/csd-percent-rpm</independentVar>
							<tableData>
								74    0
								75  115
							</tableData>
						</table>
					</ifthen>
				</product>
			</function>
		</fcs_function>
		
		<fcs_function name="/systems/electrical/sources/idg2/output-hertz">
			<function>
				<ifthen>
					<ge>
						<property>/systems/electrical/sources/idg2/output-volt</property>
						<value>110</value>
					</ge>
					<value>400</value>
					<value>0</value>
				</ifthen>
			</function>
		</fcs_function>
		
		<!-- IDG Engine 3 -->
		<fcs_function name="/systems/electrical/sources/idg3/csd-gearbox-ratio"> <!-- Goal is 75% RPM -->
			<function>
				<table>
					<independentVar lookup="row">/engines/engine[2]/n2-actual</independentVar>
					<tableData>
						 60  1.25000000000
						 70  1.07142857143
						 75  1.00000000000
						 80  0.93750000000
						 90  0.83333333333
						100  0.75000000000
						110  0.68181818182
						120  0.62500000000
					</tableData>
				</table>
			</function>
		</fcs_function>
		
		<pure_gain name="/systems/electrical/sources/idg3/csd-percent-rpm">
			<input>/engines/engine[2]/n2-actual</input>
			<gain>/systems/electrical/sources/idg3/csd-gearbox-ratio</gain>
		</pure_gain>
		
		<fcs_function name="/systems/electrical/sources/idg3/output-volt">
			<function>
				<product>
					<property>/controls/electrical/switches/gen-drive-3</property>
					<ifthen>
						<eq>
							<property>/systems/failures/elec-gen3</property>
							<value>1</value>
						</eq>
						<value>0</value>
						<table>
							<independentVar lookup="row">/systems/electrical/sources/idg3/csd-percent-rpm</independentVar>
							<tableData>
								74    0
								75  115
							</tableData>
						</table>
					</ifthen>
				</product>
			</function>
		</fcs_function>
		
		<fcs_function name="/systems/electrical/sources/idg3/output-hertz">
			<function>
				<ifthen>
					<ge>
						<property>/systems/electrical/sources/idg3/output-volt</property>
						<value>110</value>
					</ge>
					<value>400</value>
					<value>0</value>
				</ifthen>
			</function>
		</fcs_function>
		
		<!-- APU Gen -->
		<fcs_function name="/systems/electrical/sources/apu/output-volt">
			<function>
				<ifthen>
					<eq>
						<property>/systems/failures/elec-apu</property>
						<value>1</value>
					</eq>
					<value>0</value>
					<table>
						<independentVar lookup="row">/systems/apu/n2</independentVar>
						<tableData>
							94    0
							95  115
						</tableData>
					</table>
				</ifthen>
			</function>
		</fcs_function>
		
		<fcs_function name="/systems/electrical/sources/apu/output-hertz">
			<function>
				<ifthen>
					<ge>
						<property>/systems/electrical/sources/apu/output-volt</property>
						<value>110</value>
					</ge>
					<value>400</value>
					<value>0</value>
				</ifthen>
			</function>
		</fcs_function>
		
		<!-- External Power -->
		<fcs_function name="/systems/electrical/sources/ext/output-volt">
			<function>
				<ifthen>
					<eq>
						<property>/controls/switches/cart</property>
						<value>1</value>
					</eq>
					<value>115</value>
					<value>0</value>
				</ifthen>
			</function>
			<output>/systems/electrical/sources/ext/output-galley-volt</output>
		</fcs_function>
		
		<fcs_function name="/systems/electrical/sources/ext/output-hertz">
			<function>
				<ifthen>
					<ge>
						<property>/systems/electrical/sources/ext/output-volt</property>
						<value>110</value>
					</ge>
					<value>400</value>
					<value>0</value>
				</ifthen>
			</function>
			<output>/systems/electrical/sources/ext/output-galley-hertz</output>
		</fcs_function>
		
		<!-- Air Driven Generator Power -->
		<fcs_function name="/systems/electrical/sources/adg/output-volt">
			<function>
				<ifthen>
					<eq>
						<property>/controls/switches/adg-handle</property>
						<value>1</value>
					</eq>
					<table>
						<independentVar lookup="row">velocities/vc-kts</independentVar>
						<tableData>
							 50    0
							 80  115
						</tableData>
					</table>
					<value>0</value>
				</ifthen>
			</function>
		</fcs_function>
		
		<fcs_function name="/systems/electrical/sources/adg/output-hertz">
			<function>
				<ifthen>
					<ge>
						<property>/systems/electrical/sources/adg/output-volt</property>
						<value>110</value>
					</ge>
					<value>400</value>
					<value>0</value>
				</ifthen>
			</function>
		</fcs_function>
		
		<!-- ADG Bus -->
		<pure_gain name="/systems/electrical/bus/adg">
			<input>/systems/electrical/sources/adg/output-volt</input>
			<gain>1.0</gain>
		</pure_gain>
		
		<!-- AC 1 Bus/AC Gen 1 Bus -->
		<switch name="/systems/electrical/bus/ac-gen-1-src">
			<description>Tell which source is being used, so that the system cannot magically power itself using AC tie</description>
			<default value="0"/> <!-- OFF -->
			<test logic="AND" value="1"> <!-- IDG1 -->
				/systems/electrical/sources/idg1/output-volt ge 110
				/controls/electrical/switches/gen-1 eq 1
			</test>
			<test logic="AND" value="2"> <!-- APU -->
				/systems/electrical/sources/apu/output-volt ge 110
				/controls/electrical/switches/apu-pwr eq 1
			</test>
			<test logic="AND" value="3"> <!-- AC TIE -->
				/systems/electrical/bus/ac-tie-feedback ge 110
				/controls/electrical/switches/ac-tie-1 eq 1
			</test>
		</switch>
		
		<switch name="/systems/electrical/bus/ac-gen-1">
			<default value="0"/>
			<test value="/systems/electrical/sources/idg1/output-volt">
				/systems/electrical/bus/ac-gen-1-src eq 1
			</test>
			<test value="/systems/electrical/sources/apu/output-volt">
				/systems/electrical/bus/ac-gen-1-src eq 2
			</test>
			<test value="/systems/electrical/bus/ac-tie-feedback">
				/systems/electrical/bus/ac-gen-1-src eq 3
			</test>
		</switch>
		
		<pure_gain name="/systems/electrical/bus/ac-1">
			<input>/systems/electrical/bus/ac-gen-1</input>
			<gain>1.0</gain>
		</pure_gain>
		
		<!-- Galley 1 Bus -->
		<switch name="/systems/electrical/bus/galley-1">
			<default value="0"/>
			<test logic="AND" value="0">
				/systems/electrical/sources/ext/output-galley-volt ge 110
				/controls/electrical/switches/ext-pwr eq 1
				/controls/electrical/switches/extg-pwr ne 1
				/systems/electrical/bus/ac-gen-1-src eq 3
			</test>
			<test logic="AND" value="/systems/electrical/bus/ac-1">
				/systems/electrical/bus/ac-1 ge 110
				/controls/electrical/switches/galley-1 eq 1
			</test>
			<test logic="AND" value="/systems/electrical/sources/ext/output-volt">
				/systems/electrical/sources/ext/output-galley-volt ge 110
				/controls/electrical/switches/extg-pwr eq 1
			</test>
		</switch>
		
		<!-- AC 2 Bus/AC Gen 2 Bus -->
		<switch name="/systems/electrical/bus/ac-gen-2-src">
			<description>Tell which source is being used, so that the system cannot magically power itself using AC tie</description>
			<default value="0"/> <!-- OFF -->
			<test logic="AND" value="1"> <!-- IDG2 -->
				/systems/electrical/sources/idg2/output-volt ge 110
				/controls/electrical/switches/gen-2 eq 1
			</test>
			<test logic="AND" value="2"> <!-- APU -->
				/systems/electrical/sources/apu/output-volt ge 110
				/controls/electrical/switches/apu-pwr eq 1
			</test>
			<test logic="AND" value="3"> <!-- AC TIE -->
				/systems/electrical/bus/ac-tie-feedback ge 110
				/controls/electrical/switches/ac-tie-2 eq 1
			</test>
		</switch>
		
		<switch name="/systems/electrical/bus/ac-gen-2">
			<default value="0"/>
			<test value="/systems/electrical/sources/idg2/output-volt">
				/systems/electrical/bus/ac-gen-2-src eq 1
			</test>
			<test value="/systems/electrical/sources/apu/output-volt">
				/systems/electrical/bus/ac-gen-2-src eq 2
			</test>
			<test value="/systems/electrical/bus/ac-tie-feedback">
				/systems/electrical/bus/ac-gen-2-src eq 3
			</test>
		</switch>
		
		<pure_gain name="/systems/electrical/bus/ac-2">
			<input>/systems/electrical/bus/ac-gen-2</input>
			<gain>1.0</gain>
		</pure_gain>
		
		<!-- Galley 2 Bus -->
		<switch name="/systems/electrical/bus/galley-2">
			<default value="0"/>
			<test logic="AND" value="0">
				/systems/electrical/sources/ext/output-galley-volt ge 110
				/controls/electrical/switches/ext-pwr eq 1
				/controls/electrical/switches/extg-pwr ne 1
				/systems/electrical/bus/ac-gen-2-src eq 3
			</test>
			<test logic="AND" value="/systems/electrical/bus/ac-2">
				/systems/electrical/bus/ac-2 ge 110
				/controls/electrical/switches/galley-2 eq 1
			</test>
			<test logic="AND" value="/systems/electrical/sources/ext/output-volt">
				/systems/electrical/sources/ext/output-galley-volt ge 110
				/controls/electrical/switches/extg-pwr eq 1
			</test>
		</switch>
		
		<!-- AC 3 Bus/AC Gen 3 Bus -->
		<switch name="/systems/electrical/bus/ac-gen-3-src">
			<description>Tell which source is being used, so that the system cannot magically power itself using AC tie</description>
			<default value="0"/> <!-- OFF -->
			<test logic="AND" value="1"> <!-- IDG3 -->
				/systems/electrical/sources/idg3/output-volt ge 110
				/controls/electrical/switches/gen-3 eq 1
			</test>
			<test logic="AND" value="2"> <!-- APU -->
				/systems/electrical/sources/apu/output-volt ge 110
				/controls/electrical/switches/apu-pwr eq 1
			</test>
			<test logic="AND" value="3"> <!-- AC TIE -->
				/systems/electrical/bus/ac-tie-feedback ge 110
				/controls/electrical/switches/ac-tie-3 eq 1
			</test>
		</switch>
		
		<switch name="/systems/electrical/bus/ac-gen-3">
			<default value="0"/>
			<test value="/systems/electrical/sources/idg3/output-volt">
				/systems/electrical/bus/ac-gen-3-src eq 1
			</test>
			<test value="/systems/electrical/sources/apu/output-volt">
				/systems/electrical/bus/ac-gen-3-src eq 2
			</test>
			<test value="/systems/electrical/bus/ac-tie-feedback">
				/systems/electrical/bus/ac-gen-3-src eq 3
			</test>
		</switch>
		
		<pure_gain name="/systems/electrical/bus/ac-3">
			<input>/systems/electrical/bus/ac-gen-3</input>
			<gain>1.0</gain>
		</pure_gain>
		
		<!-- Galley 3 Bus -->
		<switch name="/systems/electrical/bus/galley-3">
			<default value="0"/>
			<test logic="AND" value="0">
				/systems/electrical/sources/ext/output-galley-volt ge 110
				/controls/electrical/switches/ext-pwr eq 1
				/controls/electrical/switches/extg-pwr ne 1
				/systems/electrical/bus/ac-gen-3-src eq 3
			</test>
			<test logic="AND" value="/systems/electrical/bus/ac-3">
				/systems/electrical/bus/ac-3 ge 110
				/controls/electrical/switches/galley-3 eq 1
			</test>
			<test logic="AND" value="/systems/electrical/sources/ext/output-volt">
				/systems/electrical/sources/ext/output-galley-volt ge 110
				/controls/electrical/switches/extg-pwr eq 1
			</test>
		</switch>
		
		<!-- AC Tie Bus -->
		<switch name="/systems/electrical/bus/ac-tie">
			<default value="0"/>
			<test logic="AND" value="/systems/electrical/sources/ext/output-volt">
				/systems/electrical/sources/ext/output-volt ge 110
				/controls/electrical/switches/ext-pwr eq 1
			</test>
			<test logic="AND" value="/systems/electrical/bus/ac-gen-1">
				/systems/electrical/bus/ac-gen-1 ne 0
				/systems/electrical/bus/ac-gen-1-src ne 3
				/controls/electrical/switches/ac-tie-1 eq 1
			</test>
			<test logic="AND" value="/systems/electrical/bus/ac-gen-2">
				/systems/electrical/bus/ac-gen-2 ne 0
				/systems/electrical/bus/ac-gen-2-src ne 3
				/controls/electrical/switches/ac-tie-2 eq 1
			</test>
			<test logic="AND" value="/systems/electrical/bus/ac-gen-3">
				/systems/electrical/bus/ac-gen-3 ne 0
				/systems/electrical/bus/ac-gen-3-src ne 3
				/controls/electrical/switches/ac-tie-3 eq 1
			</test>
			<output>/systems/electrical/bus/ac-tie-feedback</output>
		</switch>
		
		<!-- Right Emergency AC Bus -->
		<switch name="/systems/electrical/bus/r-emer-ac">
			<default value="0"/>
			<test value="/systems/electrical/bus/ac-gen-3">
				/systems/electrical/bus/ac-gen-3 ge 110
			</test>
			<test logic="AND" value="/systems/electrical/bus/adg">
				/systems/electrical/bus/adg ge 110
				/controls/electrical/switches/adg-elec eq 1
			</test>
		</switch>
		
		<!-- AC Ground Service Bus -->
		<switch name="/systems/electrical/bus/ac-gndsvc">
			<default value="0"/>
			<test logic="AND" value="/systems/electrical/bus/ac-gen-2">
				/systems/electrical/bus/ac-gen-2 ge 110
			</test>
			<test logic="AND" value="/systems/electrical/sources/ext/output-volt">
				/systems/electrical/sources/ext/output-volt ge 110
				/controls/electrical/switches/ext-pwr eq 1
			</test>
		</switch>
		
		<!-- Transformer Rectifiers 1/2A/2B/3 -->
		<pure_gain name="/systems/electrical/sources/tr1/output-volt">
			<input>/systems/electrical/bus/ac-gen-1</input>
			<gain>0.24347826086956523</gain> <!-- AC to DC converter -->
		</pure_gain>
		
		<fcs_function name="/systems/electrical/sources/tr1/output-amp">
			<function>
				<table>
					<independentVar lookup="row">/systems/electrical/sources/tr1/output-volt</independentVar>
					<tableData>
						 0    0
						10   75
					</tableData>
				</table>
			</function>
		</fcs_function>
		
		<pure_gain name="/systems/electrical/sources/tr2a/output-volt">
			<input>/systems/electrical/bus/ac-gen-2</input>
			<gain>0.24347826086956523</gain> <!-- AC to DC converter -->
		</pure_gain>
		
		<fcs_function name="/systems/electrical/sources/tr2a/output-amp">
			<function>
				<table>
					<independentVar lookup="row">/systems/electrical/sources/tr2a/output-volt</independentVar>
					<tableData>
						 0    0
						10   75
					</tableData>
				</table>
			</function>
		</fcs_function>
		
		<pure_gain name="/systems/electrical/sources/tr2b/output-volt">
			<input>/systems/electrical/bus/ac-gndsvc</input>
			<gain>0.24347826086956523</gain> <!-- AC to DC converter -->
		</pure_gain>
		
		<fcs_function name="/systems/electrical/sources/tr2b/output-amp">
			<function>
				<table>
					<independentVar lookup="row">/systems/electrical/sources/tr2b/output-volt</independentVar>
					<tableData>
						 0    0
						10   75
					</tableData>
				</table>
			</function>
		</fcs_function>
		
		<pure_gain name="/systems/electrical/sources/tr3/output-volt">
			<input>/systems/electrical/bus/r-emer-ac</input>
			<gain>0.24347826086956523</gain> <!-- AC to DC converter -->
		</pure_gain>
		
		<fcs_function name="/systems/electrical/sources/tr3/output-amp">
			<function>
				<table>
					<independentVar lookup="row">/systems/electrical/sources/tr3/output-volt</independentVar>
					<tableData>
						 0    0
						10   75
					</tableData>
				</table>
			</function>
		</fcs_function>
		
		<!-- DC Ground Service Bus -->
		<switch name="/systems/electrical/bus/dc-gndsvc-src">
			<default value="0"/> <!-- OFF -->
			<test value="1"> <!-- TR2B -->
				/systems/electrical/sources/tr2b/output-volt ge 25
			</test>
			<test value="2"> <!-- DC TIE -->
				/systems/electrical/bus/dc-tie-feedback ge 25
			</test>
		</switch>
		
		<switch name="/systems/electrical/bus/dc-gndsvc">
			<default value="0"/>
			<test value="/systems/electrical/sources/tr2b/output-volt">
				/systems/electrical/bus/dc-gndsvc-src eq 1
			</test>
			<test value="/systems/electrical/bus/dc-tie-feedback">
				/systems/electrical/bus/dc-gndsvc-src eq 2
			</test>
		</switch>
		
		<!-- Right Emergency DC Bus -->
		<switch name="/systems/electrical/bus/r-emer-dc">
			<default value="0"/>
			<test value="/systems/electrical/sources/tr3/output-volt">
				/systems/electrical/sources/tr3/output-volt ge 25
			</test>
		</switch>
		
		<!-- DC 1 Bus -->
		<switch name="/systems/electrical/bus/dc-1-src">
			<description>Tell which source is being used, so that the system cannot magically power itself using DC tie</description>
			<default value="0"/> <!-- OFF -->
			<test logic="AND" value="1"> <!-- TR1 -->
				/systems/electrical/sources/tr1/output-volt ge 25
				/controls/electrical/switches/gen-1 eq 1
			</test>
			<test logic="AND" value="2"> <!-- DC TIE -->
				/systems/electrical/bus/dc-tie-feedback ge 25
				/controls/electrical/switches/dc-tie-1 eq 1
			</test>
		</switch>
		
		<switch name="/systems/electrical/bus/dc-1">
			<default value="0"/>
			<test value="/systems/electrical/sources/tr1/output-volt">
				/systems/electrical/bus/dc-1-src eq 1
			</test>
			<test value="/systems/electrical/bus/dc-tie-feedback">
				/systems/electrical/bus/dc-1-src eq 2
			</test>
		</switch>
		
		<!-- DC 2 Bus -->
		<switch name="/systems/electrical/bus/dc-2-src">
			<description>Tell which source is being used, so that the system cannot magically power itself using DC tie</description>
			<default value="0"/> <!-- OFF -->
			<test logic="AND" value="1"> <!-- TR2A -->
				/systems/electrical/sources/tr2a/output-volt ge 25
				/controls/electrical/switches/gen-2 eq 1
			</test>
			<test value="2"> <!-- DC TIE -->
				/systems/electrical/bus/dc-tie-feedback ge 25
			</test>
		</switch>
		
		<switch name="/systems/electrical/bus/dc-2">
			<default value="0"/>
			<test value="/systems/electrical/sources/tr2a/output-volt">
				/systems/electrical/bus/dc-2-src eq 1
			</test>
			<test value="/systems/electrical/bus/dc-tie-feedback">
				/systems/electrical/bus/dc-2-src eq 2
			</test>
		</switch>
		
		<!-- DC 3 Bus -->
		<switch name="/systems/electrical/bus/dc-3-src">
			<description>Tell which source is being used, so that the system cannot magically power itself using DC tie</description>
			<default value="0"/> <!-- OFF -->
			<test logic="AND" value="1"> <!-- TR1 -->
				/systems/electrical/sources/tr3/output-volt ge 25
				/controls/electrical/switches/gen-3 eq 1
			</test>
			<test logic="AND" value="2"> <!-- DC TIE -->
				/systems/electrical/bus/dc-tie-feedback ge 25
				/controls/electrical/switches/dc-tie-3 eq 1
			</test>
		</switch>
		
		<switch name="/systems/electrical/bus/dc-3">
			<default value="0"/>
			<test value="/systems/electrical/sources/tr3/output-volt">
				/systems/electrical/bus/dc-3-src eq 1
			</test>
			<test value="/systems/electrical/bus/dc-tie-feedback">
				/systems/electrical/bus/dc-3-src eq 2
			</test>
		</switch>
		
		<!-- Battery Bus/Battery Direct Bus -->
		<fcs_function name="/systems/electrical/bus/dc-bat-direct">
			<function>
				<max>
					<property>/systems/electrical/sources/bat1/volts</property>
					<property>/systems/electrical/sources/bat2/volts</property>
				</max>
			</function>
		</fcs_function>
		
		<switch name="/systems/electrical/bus/dc-bat">
			<default value="0"/>
			<test value="/systems/electrical/bus/dc-2">
				/systems/electrical/bus/dc-2 ge 25
			</test>
			<test value="/systems/electrical/bus/dc-gndsvc">
				/systems/electrical/bus/dc-gndsvc ge 25
			</test>
			<test logic="AND" value="/systems/electrical/sources/tr3/output-volt">
				/systems/electrical/sources/tr3/output-volt ge 25
				/controls/electrical/switches/adg-elec eq 1
			</test>
			<test logic="AND" value="/systems/electrical/bus/dc-bat-direct">
				/systems/electrical/bus/dc-bat-direct ge 25
				/controls/electrical/switches/battery eq 1
			</test>
		</switch>
		
		<!-- DC Tie Bus -->
		<switch name="/systems/electrical/bus/dc-tie">
			<default value="0"/>
			<test value="/systems/electrical/bus/dc-2">
				/systems/electrical/bus/dc-2-src eq 1
			</test>
			<test logic="AND" value="/systems/electrical/bus/dc-1">
				/systems/electrical/bus/dc-1-src eq 1
				/controls/electrical/switches/dc-tie-1 eq 1
			</test>
			<test logic="AND" value="/systems/electrical/bus/dc-3">
				/systems/electrical/bus/dc-3-src eq 1
				/controls/electrical/switches/dc-tie-3 eq 1
			</test>
			<test value="/systems/electrical/bus/dc-gndsvc">
				/systems/electrical/bus/dc-gndsvc-src eq 1
			</test>
			<output>/systems/electrical/bus/dc-tie-feedback</output>
		</switch>
		
		<!-- Left Emergency DC Bus -->
		<switch name="/systems/electrical/bus/l-emer-dc">
			<default value="0"/>
			<test value="/systems/electrical/bus/dc-1">
				/systems/electrical/bus/dc-1 ge 25
			</test>
			<test logic="AND" value="/systems/electrical/bus/dc-bat">
				/systems/electrical/bus/dc-bat ge 25
				/controls/electrical/switches/emer-pw-sw gt 0
			</test>
			<test logic="AND" value="/systems/electrical/sources/tr3/output-volt">
				/systems/electrical/sources/tr3/output-volt ge 25
				/controls/electrical/switches/adg-elec eq 1
			</test>
		</switch>
		
		<!-- Static Inverter 1 -->
		<fcs_function name="/systems/electrical/sources/si1/output-volt">
			<description>Static Inverter 1</description>
			<function>
				<table> <!-- DC to AC converter -->
					<independentVar lookup="row">/systems/electrical/bus/l-emer-dc</independentVar>
					<tableData>
						 0    0
						25  110
						28  115
					</tableData>
				</table>
			</function>
		</fcs_function>
		
		<!-- Left Emergency AC Bus -->
		<switch name="/systems/electrical/bus/l-emer-ac">
			<default value="0"/>
			<test value="/systems/electrical/bus/ac-gen-1">
				/systems/electrical/bus/ac-gen-1 ge 110
			</test>
			<test logic="AND" value="/systems/electrical/sources/si1/output-volt">
				/systems/electrical/sources/si1/output-volt ge 110
				/controls/electrical/switches/emer-pw-sw gt 0
			</test>
			<test value="/systems/electrical/bus/adg">
				/systems/electrical/bus/adg ge 110
			</test>
		</switch>
		
		<!-- Output to Generics -->
		<switch name="/systems/electrical/generic-pwr">
			<description>This makes the FG stuff work because we killed the generic electrical</description>
			<default value="0"/>
			<test value="/systems/electrical/bus/dc-1">
				/systems/electrical/bus/dc-1 ge 25
			</test>
			<test value="/systems/electrical/bus/dc-2">
				/systems/electrical/bus/dc-2 ge 25
			</test>
			<test value="/systems/electrical/bus/dc-3">
				/systems/electrical/bus/dc-3 ge 25
			</test>
			<output>/systems/electrical/outputs/adf</output>
			<output>/systems/electrical/outputs/dme</output>
			<output>/systems/electrical/outputs/efis</output>
			<output>/systems/electrical/outputs/fcp-power</output>
			<output>/systems/electrical/outputs/fuel-pump[0]</output>
			<output>/systems/electrical/outputs/fuel-pump[1]</output>
			<output>/systems/electrical/outputs/fuel-pump[2]</output>
			<output>/systems/electrical/outputs/gps</output>
			<output>/systems/electrical/outputs/mk-viii</output>
			<output>/systems/electrical/outputs/nav[0]</output>
			<output>/systems/electrical/outputs/nav[1]</output>
			<output>/systems/electrical/outputs/nav[2]</output>
			<output>/systems/electrical/outputs/nav[3]</output>
			<output>/systems/electrical/outputs/tacan</output>
			<output>/systems/electrical/outputs/transponder</output>
			<output>/systems/electrical/outputs/turn-coordinator</output>
		</switch>
		
		<!-- Battery Charger Powered -->
		<switch name="/systems/electrical/sources/bat-charger-powered">
			<default value="0"/>
			<test logic="OR" value="1">
				/systems/electrical/bus/ac-gndsvc ge 110
				/systems/electrical/bus/r-emer-ac ge 110
			</test>
		</switch>
	
	</channel>
	
	<channel name="ESC Switches/Logic" execrate="16"> <!-- These switches are only set in automatic mode -->
		
		<switch name="/controls/electrical/switches/allow-apu">
			<default value="0"/>
			<test logic="OR" value="1">
				/systems/electrical/bus/ac-gen-1-src ne 1
				/systems/electrical/bus/ac-gen-2-src ne 1
				/systems/electrical/bus/ac-gen-3-src ne 1
			</test>
		</switch>
		
		<switch name="/systems/electrical/esc/ac-tie-1">
			<default value="/controls/electrical/switches/ac-tie-1"/>
			<test value="1">
				/systems/electrical/system eq 1
			</test>
			<output>/controls/electrical/switches/ac-tie-1</output>
		</switch>
		
		<switch name="/systems/electrical/esc/ac-tie-2">
			<default value="/controls/electrical/switches/ac-tie-2"/>
			<test value="1">
				/systems/electrical/system eq 1
			</test>
			<output>/controls/electrical/switches/ac-tie-2</output>
		</switch>
		
		<switch name="/systems/electrical/esc/ac-tie-3">
			<default value="/controls/electrical/switches/ac-tie-3"/>
			<test value="1">
				/systems/electrical/system eq 1
			</test>
			<output>/controls/electrical/switches/ac-tie-3</output>
		</switch>
		
		<switch name="/systems/electrical/esc/apu-pwr">
			<default value="/controls/electrical/switches/apu-pwr"/>
			<test value="0">
				/controls/electrical/switches/allow-apu eq 0
			</test>
			<output>/controls/electrical/switches/apu-pwr</output>
		</switch>
		
		<switch name="/systems/electrical/esc/dc-tie-1">
			<default value="/controls/electrical/switches/dc-tie-1"/>
			<test value="1">
				/systems/electrical/system eq 1
			</test>
			<output>/controls/electrical/switches/dc-tie-1</output>
		</switch>
		
		<switch name="/systems/electrical/esc/dc-tie-3">
			<default value="/controls/electrical/switches/dc-tie-3"/>
			<test value="1">
				/systems/electrical/system eq 1
			</test>
			<output>/controls/electrical/switches/dc-tie-3</output>
		</switch>
		
		<switch name="/systems/electrical/esc/galley-1">
			<default value="/controls/electrical/switches/galley-1"/>
			<test value="1">
				/systems/electrical/system eq 1
			</test>
			<output>/controls/electrical/switches/galley-1</output>
		</switch>
		
		<switch name="/systems/electrical/esc/galley-2">
			<default value="/controls/electrical/switches/galley-2"/>
			<test value="1">
				/systems/electrical/system eq 1
			</test>
			<output>/controls/electrical/switches/galley-2</output>
		</switch>
		
		<switch name="/systems/electrical/esc/galley-3">
			<default value="/controls/electrical/switches/galley-3"/>
			<test value="1">
				/systems/electrical/system eq 1
			</test>
			<output>/controls/electrical/switches/galley-3</output>
		</switch>
		
		<switch name="/systems/electrical/esc/gen-1">
			<default value="/controls/electrical/switches/gen-1"/>
			<test logic="AND" value="1">
				/systems/electrical/system eq 1
				/systems/failures/elec-gen1 ne 1
				/controls/electrical/switches/gen-drive-1 eq 1
			</test>
			<test value="0">
				/systems/electrical/system eq 1
			</test>
			<output>/controls/electrical/switches/gen-1</output>
		</switch>
		
		<switch name="/systems/electrical/esc/gen-2">
			<default value="/controls/electrical/switches/gen-2"/>
			<test logic="AND" value="1">
				/systems/electrical/system eq 1
				/systems/failures/elec-gen2 ne 1
				/controls/electrical/switches/gen-drive-2 eq 1
			</test>
			<test value="0">
				/systems/electrical/system eq 1
			</test>
			<output>/controls/electrical/switches/gen-2</output>
		</switch>
		
		<switch name="/systems/electrical/esc/gen-3">
			<default value="/controls/electrical/switches/gen-3"/>
			<test logic="AND" value="1">
				/systems/electrical/system eq 1
				/systems/failures/elec-gen3 ne 1
				/controls/electrical/switches/gen-drive-3 eq 1
			</test>
			<test value="0">
				/systems/electrical/system eq 1
			</test>
			<output>/controls/electrical/switches/gen-3</output>
		</switch>
	
	</channel>
	
	<channel name="Overhead Lights" execrate="16">
		
		<switch name="/systems/electrical/light/emer-pw-off">
			<default value="0"/>
			<test value="1">
				/controls/electrical/switches/emer-pw-sw eq 0
			</test>
		</switch>
		
		<switch name="/systems/electrical/light/emer-pw-on">
			<default value="0"/>
			<test value="1">
				/controls/electrical/switches/emer-pw-sw eq 2
			</test>
			<test logic="AND" value="1">
				/controls/electrical/switches/emer-pw-sw eq 1
				/systems/electrical/bus/dc-1 lt 25
			</test>
		</switch>
		
		<switch name="/systems/electrical/light/bat-bus">
			<default value="0"/>
			<test value="1">
				/systems/electrical/bus/dc-bat lt 25
			</test>
		</switch>
		
		<switch name="/systems/electrical/light/l-emer-dc">
			<default value="0"/>
			<test value="1">
				/systems/electrical/bus/l-emer-dc lt 25
			</test>
		</switch>
		
		<switch name="/systems/electrical/light/dc-1">
			<default value="0"/>
			<test value="1">
				/systems/electrical/bus/dc-1 lt 25
			</test>
		</switch>
		
		<switch name="/systems/electrical/light/dc-2">
			<default value="0"/>
			<test value="1">
				/systems/electrical/bus/dc-2 lt 25
			</test>
		</switch>
		
		<switch name="/systems/electrical/light/dc-gnd">
			<default value="0"/>
			<test value="1">
				/systems/electrical/bus/dc-gndsvc lt 25
			</test>
		</switch>
		
		<switch name="/systems/electrical/light/dc-3">
			<default value="0"/>
			<test value="1">
				/systems/electrical/bus/dc-3 lt 25
			</test>
		</switch>
		
		<switch name="/systems/electrical/light/r-emer-dc">
			<default value="0"/>
			<test value="1">
				/systems/electrical/bus/r-emer-dc lt 25
			</test>
		</switch>
		
		<switch name="/systems/electrical/light/l-emer-ac">
			<default value="0"/>
			<test value="1">
				/systems/electrical/bus/l-emer-ac lt 25
			</test>
		</switch>
		
		<switch name="/systems/electrical/light/ac-1">
			<default value="0"/>
			<test value="1">
				/systems/electrical/bus/ac-1 lt 25
			</test>
		</switch>
		
		<switch name="/systems/electrical/light/ac-2">
			<default value="0"/>
			<test value="1">
				/systems/electrical/bus/ac-2 lt 25
			</test>
		</switch>
		
		<switch name="/systems/electrical/light/ac-gnd">
			<default value="0"/>
			<test value="1">
				/systems/electrical/bus/ac-gndsvc lt 25
			</test>
		</switch>
		
		<switch name="/systems/electrical/light/ac-3">
			<default value="0"/>
			<test value="1">
				/systems/electrical/bus/ac-3 lt 25
			</test>
		</switch>
		
		<switch name="/systems/electrical/light/r-emer-ac">
			<default value="0"/>
			<test value="1">
				/systems/electrical/bus/r-emer-ac lt 25
			</test>
		</switch>
		
		<switch name="/systems/electrical/light/ac-tie-1-arm">
			<default value="0"/>
			<test logic="AND" value="1">
				/controls/electrical/switches/ac-tie-1 eq 1
				/systems/electrical/bus/ac-gen-1-src eq 2
			</test>
		</switch>
		
		<switch name="/systems/electrical/light/ac-tie-2-arm">
			<default value="0"/>
			<test logic="AND" value="1">
				/controls/electrical/switches/ac-tie-2 eq 1
				/systems/electrical/bus/ac-gen-2-src eq 2
			</test>
		</switch>
		
		<switch name="/systems/electrical/light/ac-tie-3-arm">
			<default value="0"/>
			<test logic="AND" value="1">
				/controls/electrical/switches/ac-tie-3 eq 1
				/systems/electrical/bus/ac-gen-3-src eq 2
			</test>
		</switch>
		
		<switch name="/systems/electrical/light/gen-1-arm">
			<default value="0"/>
			<test logic="AND" value="1">
				/controls/electrical/switches/gen-1 eq 1
				/systems/electrical/sources/idg1/output-volt lt 110
			</test>
		</switch>
		
		<switch name="/systems/electrical/light/gen-2-arm">
			<default value="0"/>
			<test logic="AND" value="1">
				/controls/electrical/switches/gen-2 eq 1
				/systems/electrical/sources/idg2/output-volt lt 110
			</test>
		</switch>
		
		<switch name="/systems/electrical/light/gen-3-arm">
			<default value="0"/>
			<test logic="AND" value="1">
				/controls/electrical/switches/gen-3 eq 1
				/systems/electrical/sources/idg3/output-volt lt 110
			</test>
		</switch>
		
		<switch name="/systems/electrical/light/galley-1">
			<default value="0"/>
			<test value="1">
				/systems/electrical/bus/galley-1 lt 110
			</test>
		</switch>
		
		<switch name="/systems/electrical/light/galley-2">
			<default value="0"/>
			<test value="1">
				/systems/electrical/bus/galley-2 lt 110
			</test>
		</switch>
		
		<switch name="/systems/electrical/light/galley-3">
			<default value="0"/>
			<test value="1">
				/systems/electrical/bus/galley-3 lt 110
			</test>
		</switch>
	
	</channel>

</system>
